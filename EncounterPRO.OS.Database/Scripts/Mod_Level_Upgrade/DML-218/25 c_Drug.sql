
exec sp_add_epro_drug 0, 'UG', '0593','Pantop-D 20 MG / 10 MG Oral Capsule','','pantoprazole 20 MG / domperidone 10 MG Oral Capsule','KEG7213','domperidone / pantoprazole','KEGI13269','Pantop-D', 'UGBI0593'
--
exec sp_add_epro_drug 0,'UG','0669','Axcel Fungicort 2 % / 1 % Topical Cream',NULL,'miconazole nitrate 2 % / hydrocortisone acetate 1 % Topical Cream','KEG7858',NULL,NULL,NULL,NULL
exec sp_add_epro_drug 0,'UG','0713','Panto-Denk 20 MG Gastroresistant Oral Tablet','KEB10772','pantoprazole sodium 20 MG Delayed Release Oral Tablet','251872',NULL,NULL,NULL,NULL
exec sp_add_epro_drug 0,'UG','0715','Panto-Denk 40 MG Gastroresistant Oral Tablet','KEB10771','pantoprazole sodium 40 MG Delayed Release Oral Tablet','314200',NULL,NULL,NULL,NULL
exec sp_add_epro_drug 0,'UG','0719','Wepox 4000 UNITS in 1 ML Prefilled Syringe',NULL,'erythropoietin alfa 4000 UNITS in 1 ML Prefilled Syringe','KEG5773',NULL,NULL,NULL,NULL
exec sp_add_epro_drug 0,'UG','1100','Agovir 5 % Topical Cream',NULL,'acyclovir 5 % Topical Cream','141859',NULL,NULL,'Agovir',NULL
exec sp_add_epro_drug 0,'UG','1341','G-Flox 0.3 % Ophthalmic Solution',NULL,'gatifloxacin 0.3 % Ophthalmic Solution','402089',NULL,NULL,NULL,NULL
exec sp_add_epro_drug 0,'UG','1738','Tears Naturale-II 1 MG/ML / 3 MG/ML Ophthalmic Solution','KEB1668','dextran 70 0.1 % / hypromellose 0.3 % Ophthalmic Solution','309714',NULL,NULL,NULL,NULL
exec sp_add_epro_drug 0,'UG','2043','Diastop Antidiarrhoeal 300 MG / 100 MG Oral Tablet','KEB6307','activated attapulgite 300 MG / aluminium hydroxide 100 MG Oral Tablet','KEG6307',NULL,NULL,NULL,NULL
exec sp_add_epro_drug 0,'UG','2161','Cyclovax 5 % Topical Cream',NULL,'acyclovir 5 % Topical Cream','141859',NULL,NULL,'Cyclovax',NULL
exec sp_add_epro_drug 0,'UG','2671','Duolin Respules 0.5 MG / 1.25 MG in 2.5 ML Nebuliser Solution',NULL,'ipratropium bromide 500 MCG / levosalbutamol sulphate 1.25 MG in 2.5 ML Nebuliser Solution','KEG8721',NULL,NULL,NULL,NULL
exec sp_add_epro_drug 0,'UG','3003','Agovir 200 MG Oral Tablet',NULL,'acyclovir 200 MG Oral Tablet','199524',NULL,NULL,'Agovir',NULL
exec sp_add_epro_drug 0,'UG','3099','Zona 0.1 % Topical Cream',NULL,'hydrocortisone 1 % Topical Cream','106258',NULL,NULL,NULL,NULL
exec sp_add_epro_drug 0,'UG','3212','Clopress 75 MG Oral Tablet','KEB8689','clopidogrel 75 MG Oral Tablet','309362',NULL,NULL,NULL,NULL
exec sp_add_epro_drug 0,'UG','3379','Epifasi 5000 IU Injection',NULL,'chorionic gonadotrophin 5000 IU Injection','KEG13937B',NULL,NULL,NULL,NULL
exec sp_add_epro_drug 0,'UG','4303','Sayana Medroxyprogesterone Acetate 104 MG in 0.65 ML in Prefilled Syringe','KEB8413','medroxyPROGESTERone acetate 104 MG in 0.65 ML Prefilled Syringe','1000156',NULL,NULL,NULL,NULL
exec sp_add_epro_drug 0,'UG','4532','Virucid 400 MG Oral Tablet',NULL,'acyclovir 400 MG Oral Tablet','197311',NULL,NULL,'Virucid',NULL
exec sp_add_epro_drug 0,'UG','4972','LISTERINE Antiseptic 0.092 % / 0.042 % / 0.06 % / 0.064 % Mouthwash','1043623','eucalyptol 0.092 % / menthol 0.042 % / methyl salicylate 0.06 % / thymol 0.064 % Mouthwash','1043619',NULL,NULL,NULL,NULL
exec sp_add_epro_drug 0,'UG','5164','Bromsal Expectorant 1 MG / 2 MG / 50 MG / 0.5 MG in 5 ML Oral Solution','KEB6458','salbutamol sulphate 1 MG / bromhexine HCL 2 MG / guaiFENesin 50 MG / menthol 0.5 MG in 5 ML Oral Solution','KEG6458',NULL,NULL,NULL,NULL
exec sp_add_epro_drug 0,'UG','6238','Nebilong AM 5 MG / 5 MG Oral Tablet','KEB6118','amLODIPine besylate 5 MG / nebivolol HCl 5 MG Oral Tablet','KEG13461',NULL,NULL,'Nebilong-AM',NULL
exec sp_add_epro_drug 0,'UG','6314','"Elmox CV 625 MG" (amoxicillin 500 MG / clavulanate potassium 125 MG) Oral Tablet',NULL,'amoxicillin 500 MG / clavulanate potassium 125 MG Oral Tablet','617296',NULL,NULL,'Elmox CV',NULL
exec sp_add_epro_drug 0,'UG','6448','Epizolone-depot 40 MG/ML Injectable Suspension',NULL,'methylPREDNISolone acetate 40 MG/ML Injectable Suspension','1358610',NULL,NULL,NULL,NULL
exec sp_add_epro_drug 0,'UG','6552','Nurofen Migraine Pain 342 MG Oral Tablet','KEB16475','ibuprofen lysine 342 MG Oral Tablet','KEG16475',NULL,NULL,NULL,NULL
exec sp_add_epro_drug 0,'UG','6641','Ceftrisone-s 1.5 GM Injection',NULL,'cefTRIAXone 1000 MG / sulbactam 500 MG Injection','KEG11724',NULL,NULL,NULL,NULL
exec sp_add_epro_drug 0,'UG','7071','Foracort 200 MCG / 6 MCG Metered Dose Inhaler, 120 Metered Doses',NULL,'budesonide 200 MCG/ACTUAT / formoterol fumarate 6 MCG/ACTUAT Metered Dose Inhaler, 120 Metered Doses','KEG2042',NULL,NULL,NULL,NULL
exec sp_add_epro_drug 0,'UG','7077','Foracort 400 MCG / 6 MCG Metered Dose Inhaler, 120 Metered Doses',NULL,'budesonide 400 MCG/ACTUAT / formoterol fumarate 6 MCG/ACTUAT Metered Dose Inhaler, 120 Metered Doses','KEG2044',NULL,NULL,NULL,NULL
exec sp_add_epro_drug 0,'UG','7588','Exevate-MF 0.05 % / 3 % / 10 % / 3 % / 2 % Topical Ointment','KEB6607','betamethasone dipropionate 0.05 % / salicylic acid 3 % / urea 10 % / lactic acid 3 % / sodium lactate 2 % Topical Ointment','KEG6607',NULL,NULL,NULL,NULL
exec sp_add_epro_drug 0,'UG','8919','SCC4 (150 MG / 75 MG / 400 MG / 275 MG) Oral Tablet',NULL,'rifampicin 150 MG / isoniazid 75 MG / pyrazinamide 400 MG / ethambutol 275 MG Oral Tablet','KEG1081',NULL,NULL,NULL,NULL
exec sp_add_epro_drug 0,'UG','9306','Funbact-A 1 % / 0.05 % / 0.5 % Topical Cream','KEB9772','clotrimazole 1 % / betamethasone 0.05 % / neomycin 0.5 % Topical Cream','KEG9772',NULL,NULL,NULL,NULL


;with dupes as (
select form_rxcui
from c_Drug_Package dp 
group by form_rxcui
having count(*) > 1
) 
delete dp
-- select p.form_rxcui, dp.drug_id, g.drug_id, f.form_descr, p1.description
from c_Drug_Package dp
join dupes p ON p.form_rxcui = dp.form_rxcui
join c_Drug_Formulation f ON dp.form_rxcui = f.form_rxcui
join c_Drug_Generic g on g.generic_rxcui = f.ingr_rxcui
join c_Package p1 on p1.package_id = dp.package_id
where dp.drug_id != g.drug_id


;with dupes as (
select form_rxcui
from c_Drug_Package dp 
group by form_rxcui
having count(*) > 1
) 
delete dp
-- select p.form_rxcui, dp.drug_id, b.drug_id, f.form_descr, p1.description
from c_Drug_Package dp
join dupes p ON p.form_rxcui = dp.form_rxcui
join c_Drug_Formulation f ON dp.form_rxcui = f.form_rxcui
join c_Drug_Brand b on b.brand_name_rxcui = f.ingr_rxcui
join c_Package p1 on p1.package_id = dp.package_id
where dp.drug_id != b.drug_id

exec sp_supply_missing_dose_unit

/*
select ingr_rxcui, s.generic_rxcui, form_descr, source_generic_form_descr , reviewed
from c_Drug_Formulation f
join c_Drug_Source_Formulation s ON s.generic_form_rxcui = f.form_rxcui
join Uganda_Drugs u ON u.NDA_MAL_HDP = s.source_id
left join c_Drug_Generic g ON g.generic_rxcui = f.ingr_rxcui
left join c_Drug_Brand b ON b.brand_name_rxcui = f.ingr_rxcui
WHERE b.brand_name_rxcui IS NULL AND g.generic_rxcui IS NULL

select * from Uganda_Drugs u
join c_Drug_Formulation f on f.form_rxcui = u.generic_form_RXCUI
join c_Drug_Source_Formulation s ON s.generic_form_rxcui = f.form_rxcui
where reviewed between 1 and 4 
and u.generic_ingr_RXCUI is null 

select * from c_Drug_Brand where brand_name like 'Proloc-D'
where brand_name_rxcui = 'UGBI0593'
UGBI0593	BN_UG	ug;	KEG7213
select * from c_Drug_Generic
where generic_rxcui in ( 'KEGI13269')
select * from c_Drug_Formulation
where form_rxcui in ('KEG7213', 'UGB0593')


meningococcal polysaccharide, groups A, C, Y and W-135 conjugate vaccine 0.5 mL Injection	KEGI12367
Pregavalex 75 mG Oral Capsule	UGBI7199
Pregavalex 150 mG Oral Capsule	UGBI7199
salbutamol sulphate 2 mG / bromhexine HCl 4 mG / guaiFENesin 100 mG / menthol 1 mG in 10 mL Oral Solution	UGGI4855
bisOPROLOl FUMARATE / amLODIPine BESILATE 10 MG / 5 MG	UGGI9413
bisOPROLOl FUMARATE / amLODIPine BESILATE 5 MG / 10 MG	UGGI9416
*/