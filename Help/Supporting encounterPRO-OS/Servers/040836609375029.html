<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <meta name="PROBLEM" content="sp_rebuild_constraints fails" />
    <meta name="TITLE" content="sp_rebuild_constraints fails" />
    <meta name="DESCRIPTION" content="" />
    <meta name="PROBLEM_TYPE" content="Problem Solution" />
    <meta name="AUDIENCE" content="sa" />
	<meta name="KEYWORDS" content="sp_rebuild_constraints" />
    <link rel="stylesheet" type="text/css" href="images/common.css" />
    
    <title>sp_rebuild_constraints fails</title>
</head>

<script type="text/javascript">function popup(image, width, height) { window.open(image, 'popup', 'width=' + width + ',height=' + height + ',scrollbars=yes'); }</script>

<body>
    <img src="images/logo.gif" border="0" alt="RightAnswers, Inc" /><br />
    <br />
    <hr />
    
    <!-- Begin Solution -->

	<div class="solutionPath"><b>Solution Path:</b> Supporting encounterPRO-OS &gt; Servers</div>
<hr />
<h2>sp_rebuild_constraints fails</h2><table cellpadding="5" cellspacing="0" border="0" class="solutionTable">
<tr>
<td class="sectionLabel">
Cause:
</td>
<td class="sectionContent">

</td>
</tr>
<tr>
<td class="sectionLabel">
Solution:
</td>
<td class="sectionContent">
<OL> 
<LI class=numbers1>From the log, determine which table is failing. This will likely be the last table to have a 'Start...' log entry without a corresponding 'Finished...' log entry.  
<LI class=numbers1>Run sp_rebuild_constraints for only&nbsp;the table that failed:&nbsp; sp_rebuild_constraints 'tablename<TABLENAME>'  
<LI class=numbers1>If that fails, run DBCC CHECKTABLE for that table:&nbsp; DBCC CHECKTABLE (tablename<TABLENAME>)  
<LI class=numbers1>If that fails, then treat this as a database corruption issue.&nbsp; If DBCC CHECKTABLE returns no errors but sp_rebuild_constraints still fails, then manually remove and rebuild the constraints to see which operation is actually failing.&nbsp; Get the current constraints script using MSACCESS from the index_script column of the appropriate record in c_Database_Table.&nbsp; Use Copy/Paste to copy the script into a query window. 
<OL> 
<LI class=numbers1>Drop the existing constraints:&nbsp; sp_drop_constraints 'tablename<TABLENAME>'  
<LI class=numbers1>execute each GO block of the constraints script for that table one at a time.&nbsp; If one of the constraints fails to create then troubleshoot that statement</LI></OL></LI></OL>
</td>
</tr>
<tr>
<td class="sectionLabel">
Details:
</td>
<td class="sectionContent">

</td>
</tr>
<tr>
<td class="sectionLabel">
Symptoms:
</td>
<td class="sectionContent">

</td>
</tr>
</table>
<br />
<hr />
<table cellpadding="0" cellspacing="0" border="0" width="100%">
<tr>
<td>
<b>ID:</b> 040836609375029</td>
<td style="text-align: right;">
<b>Last Modified:</b> 01/02/2009 10:52:10 AM</td>
</tr>
</table>

    
    <!-- End Solution -->
	<br />
	<hr style="height: 5px" />
	<div class="subtext"><img src="images/CC3_logo.png" hspace=3 px/>Copyright &#0169 2008-2010 by the EncounterPRO Open Source Project. You may distribute it and/or modify it under the terms of the Creative Commons Attribution License, version 3.0 or later. All trademarks within this guide belong to their legitimate owners. Please attribute the EncounterPRO Open Source Project as the creator of this work. Please include this URL for the Work: encounterpro.org <br /> <a href=http://www.librarycopyright.net/wiki/index.php?title="How_to_attribute_a_Creative_Commons_licensed_work" target="_blank">Additional Instruction</a></div> 
       
		
</body>
</html>