$PBExportHeader$w_ext_observation_wlca_spotcheck.srw
forward
global type w_ext_observation_wlca_spotcheck from window
end type
type ole_spotcheck from olecustomcontrol within w_ext_observation_wlca_spotcheck
end type
end forward

global type w_ext_observation_wlca_spotcheck from window
boolean visible = false
integer width = 2533
integer height = 1408
boolean titlebar = true
string title = "Untitled"
long backcolor = 67108864
ole_spotcheck ole_spotcheck
end type
global w_ext_observation_wlca_spotcheck w_ext_observation_wlca_spotcheck

type variables
u_component_observation observation_component

boolean attempting_to_connect = false


end variables

forward prototypes
public function integer connect_device (string ps_commport)
public function integer connect_device ()
end prototypes

public function integer connect_device (string ps_commport);
if not isnull(ps_commport) then ole_spotcheck.object.comport = ps_commport

return connect_device()

end function

public function integer connect_device ();

if not observation_component.connected then
	attempting_to_connect = true
	ole_spotcheck.object.ConnectDevice()
	yield()
	
	// If we're still attempting to connect then the connection must have been successful
	if attempting_to_connect then
		observation_component.set_connected_status(true)
		attempting_to_connect = false
	end if
end if

if observation_component.connected then return 1

return 0

end function

event open;integer li_reconnect_timer

observation_component = message.powerobjectparm

observation_component.set_connected_status(false)

observation_component.get_attribute("reconnect_timer", li_reconnect_timer)
if not isnull(li_reconnect_timer) then timer(li_reconnect_timer)



end event

on w_ext_observation_wlca_spotcheck.create
this.ole_spotcheck=create ole_spotcheck
this.Control[]={this.ole_spotcheck}
end on

on w_ext_observation_wlca_spotcheck.destroy
destroy(this.ole_spotcheck)
end on

event timer;if not observation_component.connected then
	connect_device()
end if

end event

type ole_spotcheck from olecustomcontrol within w_ext_observation_wlca_spotcheck
event datachanged ( )
event deviceerror ( )
integer x = 699
integer y = 332
integer width = 1522
integer height = 772
integer taborder = 10
borderstyle borderstyle = stylelowered!
boolean focusrectangle = false
string binarykey = "w_ext_observation_wlca_spotcheck.win"
integer textsize = -10
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Arial"
long textcolor = 33554432
end type

event datachanged;observation_component.set_connected_status(true)
observation_component.timer_ding()



end event

event deviceerror;string ls_message
string ls_DeviceErrorCode
string ls_DeviceErrorMsg

ls_DeviceErrorCode = object.DeviceErrorCode
ls_DeviceErrorMsg = object.DeviceErrorMsg

ls_message = "Error "

if not isnull(ls_DeviceErrorCode) then
	ls_message += "(" + string(ls_DeviceErrorCode) + ") "
end if

if not isnull(ls_DeviceErrorMsg) then
	ls_message += ls_DeviceErrorMsg
end if

observation_component.mylog.log(this, "w_ext_observation_wlca_spotcheck.ole_spotcheck.deviceerror.0018", ls_message, 3)

object.DisconnectDevice()

if not attempting_to_connect then observation_component.set_connected_status(false)

attempting_to_connect = false

end event


Start of PowerBuilder Binary Data Section : Do NOT Edit
02w_ext_observation_wlca_spotcheck.bin 
2E00000e00e011cfd0e11ab1a1000000000000000000000000000000000003003e0009fffe000000060000000000000000000000010000000100000000000010000000000300000001fffffffe0000000000000000fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffd00000002fffffffefffffffe00000005fffffffeffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff006f00520074006f004500200074006e00790072000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000050016ffffffffffffffff0000000300000000000000000000000000000000000000000000000000000000f9836b7001c1152400000004000002800000000000500003004c004200430049004e0045004500530045004b000000590000000000000000000000000000000000000000000000000000000000000000000000000002001cffffffffffffffffffffffff000000000000000000000000000000000000000000000000000000000000000000000000fffffffe000000000000000000500003004f0042005800430054005300450052004d0041000000000000000000000000000000000000000000000000000000000000000000000000000000000002001affffffffffffffffffffffff000000000000000000000000000000000000000000000000000000000000000000000000fffffffe0000000000000000004200500043004f00530058004f00540041005200450047000000000000000000000000000000000000000000000000000000000000000000000000000000000101001a000000020000000100000004476ccd0a11d3eb50500096ba2a1b580400000000f9836b7001c11524f9836b7001c11524000000000000000000000000004f00430054004e004e00450053005400000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001020012ffffffffffffffffffffffff0000000000000000000000000000000000000000000000000000000000000000000000000000000000000244000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000ffffffffffffffffffffffff0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000ffffffffffffffffffffffff0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000ffffffff
29ffffffffffffffff000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000010000000200000003000000040000000500000006000000070000000800000009fffffffeffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff0000b29300000244000800034757f20b000000200065005f00740078006e0065007800740000226b000800034757f20a000000200065005f00740078006e006500790074000013f200090008ff553307000000240069006400730061006f00740069006c000100630030000000050008b34e32e70000001c006500740070006d000100660030000000050008b34e32e20000001c006500740070006d0001006300300000000a000b1ed44aa10000002400700062006900720068006700610074006d00720000ffff0009000b235158b700000020007000620069007300740074006e0069ffff0067000800082e84b009000000200065007300690072006c0061006f006e0000000000070008cf713200000000200077007300650076006e00720000006f00000000000e0008c6b975230000002c00650064006900760065006300720065006f0072006d00720067007300000000000c000b1a8e829f00000028006800730077006f006e007500740069006e0069006f006600000000000b000b0e55145700000024006800730077006f0075006200740074006e006f00000073000d000b11902ba300000028006800730077006f00740073007400610073007500610062000000720008000b0b679aac00000020006800730077006f006500740070006d000000000008000b5f67d96e00000020006800730077006f007000730032006f000000000009000bf715e90900000020006800730077006f007500700073006c000000650006000bda8c7717fffffde0006800730077006f00700062000000000020002c006e00690065007400650067002000720065006e0077007700640069006800740020002c006e00690065007400650067002000720065006e00680077006900650068006700200074002000290072002000740065007200750073006e006c0020006e006f002000670070005b006d00620073005f007a0069005d006500730000006f00680020007700200028006f0062006c006f006100650020006e006800730077006f0020002c006f006c0067006e00730020006100740075007400200073002000290072002000740065007200750073006e006c0020006e006f002000670070005b006d00620073005f006f006800770077006e0069006f0064005d0077007300000073007900650074006b006d0079006500280020006b002000790065006f006300650064006b0020007900650020002c006e007500690073006e006700640065006f006c0067006e006b002000790065006c00660067006100200073002000290072002000740065007200750073006e006c0020006e006f002000670070005b006d00620073005f007300790065006b006400790077006f005d006e00740000006d0069007200650028002000290020002000200000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
12w_ext_observation_wlca_spotcheck.bin 
End of PowerBuilder Binary Data Section : No Source Expected After This Point
