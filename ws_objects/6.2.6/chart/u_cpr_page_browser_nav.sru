HA$PBExportHeader$u_cpr_page_browser_nav.sru
forward
global type u_cpr_page_browser_nav from u_cpr_page_base
end type
type ole_browser from u_browser within u_cpr_page_browser_nav
end type
type cb_back from commandbutton within u_cpr_page_browser_nav
end type
type cb_forward from commandbutton within u_cpr_page_browser_nav
end type
type cb_home from commandbutton within u_cpr_page_browser_nav
end type
end forward

global type u_cpr_page_browser_nav from u_cpr_page_base
ole_browser ole_browser
cb_back cb_back
cb_forward cb_forward
cb_home cb_home
end type
global u_cpr_page_browser_nav u_cpr_page_browser_nav

type variables
string url
boolean first_time = true

end variables

forward prototypes
public subroutine refresh ()
private function string fix_url (string ps_url)
public subroutine initialize (u_cpr_section puo_section, integer pi_page)
end prototypes

public subroutine refresh ();if first_time then ole_browser.object.navigate(url)

first_time = false

end subroutine

private function string fix_url (string ps_url);string ls_temp
string ls_url

if isnull(ps_url) then return ""

ls_url = ps_url

ls_url = f_string_substitute(ls_url, "%CPR_ID%", current_patient.cpr_id)

if not isnull(current_patient.open_encounter_id) then
	ls_temp = string(current_patient.open_encounter_id)
	ls_url = f_string_substitute(ls_url, "%ENCOUNTER_ID%", ls_temp)
end if

return ls_url

end function

public subroutine initialize (u_cpr_section puo_section, integer pi_page);integer li_width
string ls_url

this_section = puo_section
this_page = pi_page

cb_back.x = width - cb_back.width

cb_forward.x = cb_back.x
cb_home.x = cb_back.x

li_width = cb_back.x - 36

ole_browser.width = li_width
ole_browser.height = height


ole_browser.object.width = unitstopixels(li_width, XUnitsToPixels!)
ole_browser.object.height = unitstopixels(height, YUnitsToPixels!)

this_section.load_params(this_page)

ls_url = this_section.get_attribute(this_section.page[this_page].page_id, "URL")

url = fix_url(ls_url)

end subroutine

on u_cpr_page_browser_nav.create
int iCurrent
call super::create
this.ole_browser=create ole_browser
this.cb_back=create cb_back
this.cb_forward=create cb_forward
this.cb_home=create cb_home
iCurrent=UpperBound(this.Control)
this.Control[iCurrent+1]=this.ole_browser
this.Control[iCurrent+2]=this.cb_back
this.Control[iCurrent+3]=this.cb_forward
this.Control[iCurrent+4]=this.cb_home
end on

on u_cpr_page_browser_nav.destroy
call super::destroy
destroy(this.ole_browser)
destroy(this.cb_back)
destroy(this.cb_forward)
destroy(this.cb_home)
end on

type ole_browser from u_browser within u_cpr_page_browser_nav
integer width = 1559
integer height = 776
boolean bringtotop = true
string binarykey = "u_cpr_page_browser_nav.udo"
end type

event commandstatechange;
//if enable then
//	messagebox("Football", string(command) + "  true")
//else
//	messagebox("Football", string(command) + "  false")
//end if
CHOOSE CASE command
	CASE 1
		cb_forward.enabled = enable
	CASE 2
		cb_back.enabled = enable
END CHOOSE

end event

type cb_back from commandbutton within u_cpr_page_browser_nav
integer x = 2450
integer y = 4
integer width = 219
integer height = 132
integer taborder = 20
boolean bringtotop = true
integer textsize = -10
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Arial"
boolean enabled = false
string text = "Back"
end type

event clicked;ole_browser.object.goback()

end event

type cb_forward from commandbutton within u_cpr_page_browser_nav
integer x = 2450
integer y = 140
integer width = 219
integer height = 132
integer taborder = 30
boolean bringtotop = true
integer textsize = -10
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Arial"
boolean enabled = false
string text = "Fwd"
end type

event clicked;ole_browser.object.goforward()

end event

type cb_home from commandbutton within u_cpr_page_browser_nav
integer x = 2450
integer y = 276
integer width = 219
integer height = 132
integer taborder = 40
boolean bringtotop = true
integer textsize = -10
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Arial"
string text = "Home"
end type

event clicked;ole_browser.object.navigate(url)

end event


Start of PowerBuilder Binary Data Section : Do NOT Edit
03u_cpr_page_browser_nav.bin 
2F00000a00e011cfd0e11ab1a1000000000000000000000000000000000003003e0009fffe000000060000000000000000000000010000000100000000000010000000000200000001fffffffe0000000000000000fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffdfffffffefffffffefffffffeffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff006f00520074006f004500200074006e00790072000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000050016ffffffffffffffff0000000100000000000000000000000000000000000000000000000000000000a492267001c2eff600000003000000c00000000000500003004f0042005800430054005300450052004d0041000000000000000000000000000000000000000000000000000000000000000000000000000000000102001affffffff00000002ffffffff000000000000000000000000000000000000000000000000000000000000000000000000fffffffe0000000000000000004200500043004f00530058004f00540041005200450047000000000000000000000000000000000000000000000000000000000000000000000000000000000001001affffffffffffffff000000038856f96111d0340ac0006ba9a205d74f00000000a492267001c2eff6a492267001c2eff6000000000000000000000000004f00430054004e004e00450053005400000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001020012ffffffffffffffffffffffff000000000000000000000000000000000000000000000000000000000000000000000000000000000000009c000000000000000100000002fffffffeffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff
2Effffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff0000004c0000233e0000140d0000000100000005000000000000000000000000000000000000004c0000000000000000000000010057d0e011cf3573000869ae62122e2b00000008000000000000004c0002140100000000000000c046000000000000800000000000000000000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000002000002022c0000ffff000001720000001d000001720000001d000000000021e6300000000000000028000002000002022c000004f6000001780000001d0000018f00000033000000000021bac80000000000000028000002000002022c000004f80000018f0000001d000001a600000033000000000e3bddb00000000000000028000002000002022c0000ffff000001a60000001d000001a60000001d000000000020ff900000000000000028000002000002022c0000052c000001ac0000001d000001c30000003300000000001d97b80000000000000028000002000002022c0000052e000001c30000001d000001da00000033000000000481a7900000000000000028000002000002022c00000530000001da0000001d000001f1000000330000000000225ec80000000000000028000002000002022c0000ffff000001f10000001d000001f10000001d000000000019f920000000000000002800000200000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
13u_cpr_page_browser_nav.bin 
End of PowerBuilder Binary Data Section : No Source Expected After This Point
